webpackJsonp([2],{asBk:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("BO1k"),o=i.n(n),a=i("Dd8w"),s=i.n(a),l=i("is1l"),r=i("NYxO"),c=(i("ttkU"),i("gyMJ")),d={data:function(){return{singerId:"",singerName:"",visitDialog:!1,visitEditDialog:!1,visitDeleDialog:!1,form:{name:"",singerName:"",introduction:"",lyric:""},editPojo:{id:"",name:"",introduction:"",lyric:""},dataList:[],searchList:{name:""},currentPage:1,pageSize:5,idx:"-1",multipleSelection:[],toggle:!1}},created:function(){this.singerId=this.$route.query.id,this.singerName=this.$route.query.name,this.getAll()},destroyed:function(){this.$store.commit("setIsPlay",!1)},computed:s()({},Object(r.b)(["isPlay"]),{data:function(){return this.dataList.slice((this.currentPage-1)*this.pageSize,this.currentPage*this.pageSize)}}),mixins:[l.a],methods:{addSong:function(){var t=this,e=new FormData(document.getElementById("tf"));e.append("singerId",this.singerId),e.set("name",this.singerName+"-"+e.get("name")),e.get("lyric")||e.set("lyric","[00:00:00]暂无歌词");var i=new XMLHttpRequest;i.onreadystatechange=function(){4==i.readyState&&200==i.status&&(JSON.parse(i.response).code?(t.getAll(),t.form={},t.notify("保存成功","success")):t.notify("保存失败","error"))},i.open("post",t.$store.state.HOST+"/song/add",!1),i.send(e),t.visitDialog=!1},editData:function(t){this.visitEditDialog=!0,console.log(t.sex),this.editPojo={id:t.id,name:t.name,introduction:t.introduction,lyric:t.lyric}},editSong:function(){var t=this,e=new URLSearchParams;e.append("id",this.editPojo.id),e.append("name",this.editPojo.name),e.append("introduction",this.editPojo.introduction),e.append("lyric",this.editPojo.lyric),Object(c.C)(e).then(function(e){2e4==e.code?t.notify(e.message,"success"):t.notify(e.message,"error")}).catch(function(t){console.log(t)}),this.visitEditDialog=!1,this.getAll()},searchSong:function(){var t=this,e=new URLSearchParams;e.append("name",this.searchList.name),Object(c.n)(e).then(function(e){2e4==e.code&&(t.dataList=[],t.dataList=e.data)})},getAll:function(){var t=this;this.dataList=[],this.searchList=[],Object(c.o)(this.singerId).then(function(e){console.log(e.data),t.searchList=e.data,t.dataList=e.data})},uploadUrl:function(t){return this.$store.state.HOST+"/song/updateAvator?id="+t},handleCurrentChange:function(t){this.currentPage=t},deleSong:function(){var t=this;Object(c.d)(this.idx).then(function(e){2e4==e.code?(t.notify(e.message,"success"),t.visitDeleDialog=!1,t.getAll()):t.notify(e.message,"error")}).catch(function(t){console.log(t)})},deleteAll:function(){var t=this,e=!0,i=!1,n=void 0;try{for(var a,s=o()(this.multipleSelection);!(e=(a=s.next()).done);e=!0){var l=a.value;Object(c.d)(l.id).then(function(e){2e4==e.code?t.notify(e.message,"success"):t.notify(e.message,"error")}).catch(function(t){console.log(t)}),this.multipleSelection=[],this.getAll()}}catch(t){i=!0,n=t}finally{try{!e&&s.return&&s.return()}finally{if(i)throw n}}},parseLyric:function(t){var e=t.split("\n"),i=/\[\d{2}:\d{2}.(\d{3}|\d{2})\]/g,n=[],a=!0,s=!1,l=void 0;try{for(var r,c=o()(e);!(a=(r=c.next()).done);a=!0){var d=r.value.replace(i,"");n.push(d)}}catch(t){s=!0,l=t}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}return n},beforeSongUpload:function(t){return"mp3"==t.name.substring(t.name.lastIndexOf(".")+1)||(this.$message({message:"上传文件只能是mp3格式",type:"error"}),!1)},handleSongSuccess:function(t){2e4==t.code?(this.getData(),this.$notify({title:"上传成功",type:"success"})):this.$notify({title:"上传失败",type:"error"})},uploadSongUrl:function(t){return this.$store.state.HOST+"/song/updateSongUrl?id="+t},setSongUrl:function(t,e){this.toggle=e,this.$store.commit("setUrl",this.$store.state.HOST+t),this.isPlay?this.$store.commit("setIsPlay",!1):this.$store.commit("setIsPlay",!0)}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"table"},[t._m(0),t._v(" "),i("div",{staticClass:"container"},[i("el-form",{ref:"searchList",staticClass:"form-search",attrs:{inline:!0,model:t.searchList,"label-width":"60px"}},[i("el-form-item",{attrs:{label:"歌曲名称:"}},[i("el-input",{attrs:{placeholder:"请输入歌曲名称",size:"mini"},model:{value:t.searchList.name,callback:function(e){t.$set(t.searchList,"name",e)},expression:"searchList.name"}})],1),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.searchSong()}}},[t._v("查询")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.visitDialog=!0}}},[t._v("添加")]),t._v(" "),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.deleteAll()}}},[t._v("批量删除")])],1)],1)],1),t._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.data,size:"mini"},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"40"}}),t._v(" "),i("el-table-column",{attrs:{label:"歌曲图片",align:"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"song-img"},[i("img",{staticStyle:{width:"100%"},attrs:{src:t.getUrl(e.row.pic)}})]),t._v(" "),i("div",{staticClass:"play",on:{click:function(i){return t.setSongUrl(e.row.url,e.row.name)}}},[t.toggle==e.row.name?i("div",[i("svg",{staticClass:"icon"},[i("use",{attrs:{"xlink:href":"#icon-zanting"}})])]):t._e(),t._v(" "),t.toggle!=e.row.name?i("div",[i("svg",{staticClass:"icon"},[i("use",{attrs:{"xlink:href":"#icon-bofanganniu"}})])]):t._e()]),t._v(" "),i("el-upload",{attrs:{action:t.uploadUrl(e.row.id),"before-upload":t.beforeUploadAvator,"on-success":t.handleAvatorSuccess}},[i("el-button",{attrs:{size:"mini"}},[t._v("更新图片")])],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"歌名",prop:"name",align:"center",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{label:"专辑",prop:"introduction",align:"center",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{label:"歌词",align:"center",prop:"lyric"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("ul",{staticStyle:{height:"100px","overflow-y":"scroll"}},t._l(t.parseLyric(e.row.lyric),function(e,n){return i("li",{key:n},[t._v("\n                    "+t._s(e)+"\n                ")])}),0)]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"资源更新",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-upload",{attrs:{action:t.uploadSongUrl(e.row.id),"before-upload":t.beforeSongUpload,"on-success":t.handleSongSuccess}},[i("el-button",{attrs:{size:"mini"}},[t._v("更新歌曲")])],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){return t.editData(e.row)}}},[t._v("修改")]),t._v(" "),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(i){return t.deleData(e.row.id)}}},[t._v("删除")])]}}])})],1),t._v(" "),i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{background:"",layout:"total,pager,prev,next","current-page":t.currentPage,"page-size":t.pageSize,total:t.dataList.length},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),i("el-dialog",{attrs:{title:"添加歌曲",visible:t.visitDialog,width:"400px",center:""},on:{"update:visible":function(e){t.visitDialog=e}}},[i("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px",action:"",id:"tf"}},[i("div",[i("label",[t._v("歌名")]),t._v(" "),i("el-input",{attrs:{type:"text",name:"name"}})],1),t._v(" "),i("div",[i("label",[t._v("专辑")]),t._v(" "),i("el-input",{attrs:{type:"text",name:"introduction"}})],1),t._v(" "),i("div",[i("label",[t._v("歌词")]),t._v(" "),i("el-input",{attrs:{type:"textarea",name:"lyric"}})],1),t._v(" "),i("div",[i("label",[t._v("歌曲上传")]),t._v(" "),i("input",{attrs:{type:"file",name:"file"}})])]),t._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(e){t.centerDialogVisible=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:t.addSong}},[t._v("确定")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"修改歌曲",visible:t.visitEditDialog,width:"400px",center:""},on:{"update:visible":function(e){t.visitEditDialog=e}}},[i("el-form",{ref:"editPojo",attrs:{model:t.editPojo,"label-width":"80px"}},[i("el-form-item",{attrs:{prop:"name",label:"歌手-歌名",size:"mini"}},[i("el-input",{attrs:{placeholder:"歌手-歌名"},model:{value:t.editPojo.name,callback:function(e){t.$set(t.editPojo,"name",e)},expression:"editPojo.name"}})],1),t._v(" "),i("el-form-item",{attrs:{prop:"introduction",label:"专辑",size:"mini"}},[i("el-input",{attrs:{placeholder:"专辑"},model:{value:t.editPojo.introduction,callback:function(e){t.$set(t.editPojo,"introduction",e)},expression:"editPojo.introduction"}})],1),t._v(" "),i("el-form-item",{attrs:{prop:"lyric",label:"歌词",size:"mini"}},[i("el-input",{attrs:{placeholder:"歌词",type:"textarea"},model:{value:t.editPojo.lyric,callback:function(e){t.$set(t.editPojo,"lyric",e)},expression:"editPojo.lyric"}})],1)],1),t._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(e){t.editVisible=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:t.editSong}},[t._v("确定")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"删除歌曲",visible:t.visitDeleDialog,width:"400px",center:""},on:{"update:visible":function(e){t.visitDeleDialog=e}}},[i("div",[t._v("是否确定执行删除操作？")]),t._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.deleSong()}}},[t._v("是")]),t._v(" "),i("el-button",{attrs:{type:"info"},on:{click:function(e){t.visitEditDialog=!1}}},[t._v("否")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"crumbs"},[e("i",{staticClass:"el-icon-tickets"}),this._v("\n        歌曲信息\n    ")])}]};var m=i("VU/8")(d,u,!1,function(t){i("sOKZ")},"data-v-13df9d7e",null);e.default=m.exports},sOKZ:function(t,e){},ttkU:function(t,e){!function(t){var e,i='<svg><symbol id="icon-bofanganniu" viewBox="0 0 1024 1024"><path d="M927.870095 571.688039 167.320423 1014.160886C121.562471 1041.981153 61.44 1007.279555 61.44 954.218179L61.44 68.595037C63.693916 16.802233 124.631347-17.041827 171.276012 8.961322L928.382003 451.43039C974.037627 479.202079 974.037627 543.611136 927.870095 571.688039Z"  ></path></symbol><symbol id="icon-zanting" viewBox="0 0 1024 1024"><path d="M268.97201558 114.31784297c73.21218086 0 132.56071902 59.34853814 132.56071901 132.560719v530.24287606c0 73.21218086-59.34853814 132.56071902-132.56071901 132.560719s-132.56071902-59.34853814-132.56071901-132.560719V246.87856197c0-73.21218086 59.34853814-132.56071902 132.56071901-132.560719z m486.05596884 0c73.21218086 0 132.56071902 59.34853814 132.56071901 132.560719v530.24287606c0 73.21218086-59.34853814 132.56071902-132.56071901 132.560719s-132.56071902-59.34853814-132.56071901-132.560719V246.87856197c0-73.21218086 59.34853814-132.56071902 132.56071901-132.560719z"  ></path></symbol></svg>';if((e=document.getElementsByTagName("script"))[e.length-1].getAttribute("data-injectcss")&&!t.__iconfont__svg__cssinject__){t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(e){console&&console.log(e)}}!function(e){if(document.addEventListener)if(~["complete","loaded","interactive"].indexOf(document.readyState))setTimeout(e,0);else{document.addEventListener("DOMContentLoaded",function t(){document.removeEventListener("DOMContentLoaded",t,!1),e()},!1)}else document.attachEvent&&(n=e,o=t.document,a=!1,(s=function(){try{o.documentElement.doScroll("left")}catch(t){return void setTimeout(s,50)}i()})(),o.onreadystatechange=function(){"complete"==o.readyState&&(o.onreadystatechange=null,i())});function i(){a||(a=!0,n())}var n,o,a,s}(function(){var t,e;(t=document.createElement("div")).innerHTML=i,i=null,(e=t.getElementsByTagName("svg")[0])&&(e.setAttribute("aria-hidden","true"),e.style.position="absolute",e.style.width=0,e.style.height=0,e.style.overflow="hidden",function(t,e){e.firstChild?function(t,e){e.parentNode.insertBefore(t,e)}(t,e.firstChild):e.appendChild(t)}(e,document.body))})}(window)}});
//# sourceMappingURL=2.691dc026efc084bc6856.js.map